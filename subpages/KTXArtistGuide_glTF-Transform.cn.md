ä¸Šä¸€ç« : [KTX Guide for glTF-Compressor](KTXArtistGuide_glTF-Compressor.cn.md) | ä¸»é¡µ: [KTX Artist Guide](../KTXArtistGuide.cn.md) | ä¸‹ä¸€ç« : [KTX Guide for RapidCompact](KTXArtistGuide_RapidCompact.cn.md)

---

## glTF-Transform çš„ KTXæŒ‡å—

[glTF-Transform](https://gltf-transform.donmccurdy.com/cli.html) æ˜¯ç”¨äºç¼–è¾‘ glTF çš„å‘½ä»¤è¡Œå·¥å…·ã€‚

### å®‰è£… KTX è½¯ä»¶

1. è®¿é—® [KTX-Software releases](https://github.com/KhronosGroup/KTX-Software/releases).

1. æ‰¾åˆ°æ‚¨æƒ³è¦çš„ç‰ˆæœ¬ï¼ˆé€šå¸¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼‰ã€‚åœ¨ release åº•éƒ¨ï¼Œæ‰¾åˆ° Assets éƒ¨åˆ†ï¼Œç‚¹å‡»ä¸‰è§’å½¢å±•å¼€ã€‚

1. ä¸‹è½½é€‚ç”¨äºä½ çš„æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬å¹¶å®‰è£…ã€‚

1. ä¾‹å¦‚ï¼ŒWindows å®‰è£…ç¨‹åºå¦‚ä¸‹æ‰€ç¤ºï¼š

![KTX-Software setup for Windows](figures/ktx-setup-windows.jpg)

5. åœ¨ç³»ç»Ÿçš„pathç¯å¢ƒå˜é‡ä¸­æ·»åŠ  KTX-Softwareï¼Œè¿™ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†ä¼šä½¿è¿è¡Œå‘½ä»¤è¡Œå·¥å…·æ›´åŠ å®¹æ˜“ã€‚

![KTX-Software setup options](figures/ktx-setup-options.jpg)

### å®‰è£… Node.js

Node.js åŒ…å« NPM åŒ…ç®¡ç†å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥è¿è¡Œ javascript å·¥å…· [glTF-Transform](https://gltf-transform.donmccurdy.com/cli.html)ï¼Œæ¥ä½¿ç”¨ KTX çº¹ç†å‹ç¼©æŠ€æœ¯å‹ç¼©åœ¨ glTF ä¸­çš„çº¹ç†ã€‚

1. è®¿é—® https://nodejs.org/en/

1. ä¸ºæ‚¨çš„æ“ä½œç³»ç»Ÿä¸‹è½½å¹¶å®‰è£…ã€‚

1. ä¾‹å¦‚ï¼ŒWindows å®‰è£…ç¨‹åºå¦‚ä¸‹æ‰€ç¤ºï¼š

![Node.js setup for Windows](figures/nodjs-setup-windows.jpg)

4. ç¦ç”¨æ­¤å¤„çš„å¤é€‰æ¡†ï¼Œå³å¯è·³è¿‡ â€œTools for Native Modulesâ€ æ­¥éª¤ï¼š

![Node.js setup Tools for Native Modules](figures/nodjs-setup-tools.jpg)

### å®‰è£… glTF-Transform

[glTF-Transform](https://gltf-transform.donmccurdy.com/cli.html) å¯ç”¨äºå‹ç¼© glTF æ¨¡å‹ä¸­çš„å¤§éƒ¨åˆ†çº¹ç†ã€‚

1. æ‰“å¼€æ“ä½œç³»ç»Ÿçš„ CMD å·¥å…·ï¼ˆæˆ– Windows ä¸­çš„ PowerShellï¼‰ã€‚

1. å®‰è£… glTF-Transform:

``` 
npm install --location=global @gltf-transform/cli
```

### ä½¿ç”¨ glTF-Transform å‹ç¼©åˆ° KTX

ä¸€åˆ‡å®‰è£…å®Œæ¯•åï¼Œæ‚¨å°±å¯ä»¥å‹ç¼© glTF æ–‡ä»¶äº†ã€‚æœ‰ä¸åŒçš„å‹ç¼©é€‰é¡¹å¯ä¾›é€‰æ‹©ï¼›ä¸‹é¢æ˜¯å‡ ç§æ–¹æ³•ä¾›æ‚¨å‚è€ƒã€‚

### æ–¹æ³• 1: UASTC + ETC1S

ä½¿ç”¨ UASTC å‹ç¼©æ³•çº¿å’Œé®æŒ¡/ç²—ç³™åº¦/é‡‘å±æ„Ÿ (ORM) çº¹ç†ï¼Œä½¿ç”¨ ETC1S å‹ç¼©æ‰€æœ‰å…¶ä»–çº¹ç†ï¼š
```
gltf-transform uastc input.glb output1.glb --level 4 --rdo 4 --slots "{normalTexture,occlusionTexture,metallicRoughnessTexture}" --zstd 18 --verbose

gltf-transform etc1s output1.glb output2.glb --quality 255 --verbose
```

* `gltf-transform` æ˜¯å·¥å…·æœ¬èº«ã€‚
* `uastc` æ˜¯å‹ç¼©æ–¹æ³•ã€‚å®ƒçš„å‹ç¼©ç‡ä½äº etc1sï¼Œä½†äº§ç”Ÿçš„å—çŠ¶å‡è±¡ä¹Ÿè¾ƒå°‘ã€‚å¯¹äº RGB å€¼ä¸ç›¸å…³çš„çº¹ç†ï¼ˆå¦‚ ORM è´´å›¾ï¼‰ï¼Œå®ƒæ¯” ETC1S äº§ç”Ÿçš„å‡è±¡æ›´å°‘ã€‚
* `input.glb` æ˜¯è¦å‹ç¼©çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å« PNG å’Œ/æˆ– JPEG çº¹ç†ã€‚å°†å…¶é‡å‘½åä¸ºä¸è¦å‹ç¼©çš„æ–‡ä»¶ç›¸åŒ¹é…çš„åç§°ã€‚
* `output1.glb` æ˜¯è¦ä¿å­˜çš„ä¸´æ—¶æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ–°çš„ KTX çº¹ç†ã€‚ä¸Šè¿°ä»£ç å—ä¸­çš„ç¬¬ä¸€æ­¥å°†ä»…ä½¿ç”¨ UASTC å‹ç¼©æ³•çº¿å‡¹å‡¸å’Œé—­å¡-ç²—ç³™-é‡‘å±çº¹ç†ï¼Œå…¶ä»–çº¹ç†ä¿æŒåŸå§‹æ ¼å¼ã€‚ç¬¬äºŒæ­¥å°†ä½¿ç”¨ ETC1S å‹ç¼©å…¶ä½™çº¹ç†ã€‚
* `--level 4` æ˜¯ä¸€ç§é«˜è´¨é‡è®¾ç½®ã€‚å®ƒèƒ½äº§ç”Ÿå¯å®ç°çš„æœ€é«˜è´¨é‡ï¼Œä½†é€Ÿåº¦ä¼šéå¸¸æ…¢ã€‚å¦‚æœé€Ÿåº¦å¤ªæ…¢ï¼Œè¯·å°è¯• 3 çº§ã€‚
* `--rdo 4` æ˜¯ä¸­ç­‰è´¨é‡è®¾ç½®ï¼Œä½†ç”Ÿæˆçš„æ–‡ä»¶è¾ƒå°ã€‚å…¨èŒƒå›´ä¸º [.001, 10.0]ã€‚è¾ƒä½çš„å€¼ä¼šäº§ç”Ÿè¾ƒé«˜çš„è´¨é‡/è¾ƒå¤§çš„ LZ å‹ç¼©æ–‡ä»¶ï¼Œè¾ƒé«˜çš„å€¼ä¼šäº§ç”Ÿè¾ƒä½çš„è´¨é‡/è¾ƒå°çš„ LZ å‹ç¼©æ–‡ä»¶ã€‚å¯ä»¥å°è¯•çš„èŒƒå›´æ˜¯ [.25, 10]ã€‚å¯¹äºæ³•çº¿è´´å›¾ï¼Œå°è¯•çš„èŒƒå›´æ˜¯[.25, .75]ã€‚
* `--slots` å¯ä»¥åŒ…å«æˆ–æ’é™¤çº¹ç†ç±»å‹ï¼š
* `"{normalTexture,occlusionTexture,metallicRoughnessTexture}"` è®© glTF Transform ä»…ä½¿ç”¨ UASTC å‹ç¼©æ³•çº¿å’Œ ORM çº¹ç†ã€‚è¦æŸ¥çœ‹ GLB ä¸­çš„çº¹ç†æ’æ§½åˆ—è¡¨ï¼Œè¯·ä½¿ç”¨å‘½ä»¤ `gltf-transform inspect input.glb` ï¼Œè¿™å°†æ˜¾ç¤ºæ¯ä¸ªçº¹ç†çš„å°ºå¯¸å’Œæ–‡ä»¶å¤§å°ã€‚è¿™å¯¹ç¡®å®š `--slots` çš„åç§°ç‰¹åˆ«æœ‰ç”¨ï¼Œä»¥ä¾¿å¯¹ä¸åŒçš„çº¹ç†ç±»å‹åº”ç”¨ä¸åŒçš„å‹ç¼©è®¾ç½®ã€‚
* `--zstd 18` åº”ç”¨è¶…çº§å‹ç¼©ã€‚å‹ç¼©çº§åˆ«èŒƒå›´ä¸º [1ï¼Œ22]ï¼Œé»˜è®¤ä¸º 18ï¼Œ0 è¡¨ç¤ºæœªå‹ç¼©ã€‚æ•°å€¼è¶Šå°é€Ÿåº¦è¶Šå¿«ï¼Œä½†å‹ç¼©æ•ˆæœè¶Šå·®ã€‚è¶…è¿‡ 20 çš„å€¼éœ€è¦æ›´å¤šå†…å­˜ï¼Œåº”è°¨æ…ä½¿ç”¨ã€‚
* `--verbose` é€æ­¥æ˜¾ç¤º glTF Transform æ­£åœ¨è¿›è¡Œçš„æ“ä½œã€‚åœ¨ Windows ä¸Šï¼Œå‹ç¼©è¿‡ç¨‹ä¸­æ²¡æœ‰è¿›åº¦æŒ‡ç¤ºå™¨ï¼Œåªæœ‰é—ªçƒçš„å…‰æ ‡ã€‚ `--verbose` å¯ä»¥ä½œä¸ºè¿›åº¦æ¡ï¼Œç¡®ä¿å®ƒæ­£åœ¨å·¥ä½œï¼Œå¹¶å¸®åŠ©ä½ æ‰¾å‡ºæ˜¯å¦åŒ…å«äº†æ­£ç¡®çš„é€‰é¡¹ã€‚
* `output1.glb` æ˜¯ä¸Šè¿°ä»£ç å—ç¬¬ä¸€æ­¥çš„è¾“å‡ºç»“æœï¼Œç°åœ¨ç”¨äºç¬¬äºŒæ­¥ï¼Œä½¿ç”¨ ETC1S å‹ç¼©å…¶ä½™çº¹ç†ã€‚
* ç¬¬äºŒæ­¥ä¸­çš„ `output2.glb` æ˜¯æœ€ç»ˆå®Œå…¨å‹ç¼©çš„æ¨¡å‹ï¼Œæ‰€æœ‰çº¹ç†éƒ½æ˜¯ KTX æ ¼å¼ã€‚å°†å…¶é‡å‘½åä¸ºæ‰€éœ€çš„è¾“å‡ºåç§°ã€‚
* ç¬¬äºŒæ­¥ä¸­çš„ `--quality 255` ä¼šè®© glTF-Transform ä½¿ç”¨ ETC1S çš„æœ€é«˜è´¨é‡ï¼Œä½†å‹ç¼©ç‡è¾ƒä½ï¼Œå‹ç¼©æ–‡ä»¶çš„æ—¶é—´ä¹Ÿè¾ƒé•¿ã€‚å½“è´¨é‡æ¯”è½¬æ¢é€Ÿåº¦æ›´é‡è¦æ—¶ï¼Œè¯·ä½¿ç”¨æ­¤é€‰é¡¹ã€‚

> ğŸ“ æ³¨æ„: 
>  è¿™æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å‘½ä»¤ã€‚ç¬¬ä¸€æ¡å‘½ä»¤ä½¿ç”¨ UASTC ä»…å‹ç¼©æ™®é€šå’Œ ORM åœ°å›¾ã€‚ç¬¬äºŒæ¡å‘½ä»¤ä½¿ç”¨ ETC1S å‹ç¼©æ‰€æœ‰å‰©ä½™çº¹ç†ã€‚ç¬¬ 1 æ¡å‘½ä»¤å®Œæˆåå†æ‰§è¡Œç¬¬ 2 æ¡å‘½ä»¤ã€‚ç”±äº glTF-Transform ä¸ä¼šé‡æ–°å‹ç¼©ç°æœ‰çš„ KTX æ–‡ä»¶ï¼Œå› æ­¤ç¬¬ 2 æ¡å‘½ä»¤ä¸éœ€è¦ä½¿ç”¨ `--slots "!{normalTexture,occlusionTexture,metallicRoughnessTexture}"` å‚æ•°æ¥çœç•¥æ³•çº¿/ORM è´´å›¾ã€‚å®ƒåªä¼šå‹ç¼©é KTX çº¹ç†ã€‚

### æ–¹æ³• 2: UASTC

ä½¿ç”¨ UASTC å‹ç¼©æ‰€æœ‰çº¹ç†ï¼š
```
gltf-transform uastc input.glb output.glb --level 4 --rdo 4 --zstd 18 --verbose
```
* è¿™ä¼šäº§ç”Ÿè¾ƒå¤§çš„æ–‡ä»¶ï¼Œä½†é€šå¸¸æ˜¾ç¤ºè¾ƒå°‘çš„å‹ç¼©ç—•è¿¹ã€‚

### æ–¹æ³• 3: ETC1S

ä½¿ç”¨ ETC1S å‹ç¼©æ‰€æœ‰çº¹ç†ï¼š

```
gltf-transform etc1s input.glb output.glb --verbose
```
* Tè¿™æ ·ç”Ÿæˆçš„æ–‡ä»¶æœ€å°ï¼Œä½†é€šå¸¸ä¼šäº§ç”Ÿå¤§é‡å—çŠ¶ä¼ªå½±ã€‚
* å½“æ–‡ä»¶å¤§å°å’Œå†…å­˜å¤§å°æ¯”æœ€é«˜è§†è§‰è´¨é‡æ›´é‡è¦æ—¶ï¼Œè¯·ä½¿ç”¨æ­¤æ–¹æ³•ã€‚
* å¦‚æœçº¹ç†ä¸»è¦ä½¿ç”¨åŒè‰²ç³»ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•ã€‚è¯·çœ‹ä¸‹é¢çš„ Duck ç¤ºä¾‹ã€‚

### æ›´å¤šæ–¹æ³•

å°è¯•ä¸åŒçš„å‹ç¼©è®¾ç½®å’Œç»„åˆï¼›æ ¹æ®æ‚¨å¯¹å°ºå¯¸å’Œè´¨é‡çš„æ€»ä½“ç›®æ ‡è¿›è¡Œè°ƒæ•´ã€‚å¯¹ç‰¹å®šçº¹ç†æ’æ§½è¿›è¡Œéš”ç¦»è®¾ç½®ã€‚çº¹ç†å¯¹ä¸åŒå‹ç¼©è®¾ç½®çš„ååº”å„ä¸ç›¸åŒï¼Œå› æ­¤ç¨åŠ å°è¯•å°±èƒ½è·å¾—æ›´å¥½çš„æ•ˆæœã€‚

è¦äº†è§£å¯ç”¨è®¾ç½®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä»¥ä¸‹ä»»ä¸€å‘½ä»¤ï¼š
* `gltf-transform help etc1s`
* `gltf-transform help uastc`

### è¯„ä¼°è¾“å‡º

åœ¨æ‚¨é€‰æ‹©çš„æŸ¥çœ‹å™¨ä¸­ä»”ç»†æ£€æŸ¥å‹ç¼©æ–‡ä»¶ã€‚
* ä»”ç»†è§‚å¯Ÿï¼Œåœ¨ä¸åŒçš„çº¹ç†ç±»å‹ä¸Šå¯èƒ½ä¼šå‡ºç°ä¸ç†æƒ³çš„å‹ç¼©ä¼ªå½±ï¼šbasecolor, alpha, normal maps, roughness, metalness, occlusion, emissive ç­‰ã€‚
* [glTF Sample Viewer](https://github.khronos.org/glTF-Sample-Viewer-Release/) æ˜¯ä¸€ä¸ªä¸é”™çš„æ¸²æŸ“å™¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ [glTF Project Explorer](http://github.khronos.org/glTF-Project-Explorer/) æŸ¥æ‰¾ glTF æŸ¥çœ‹å™¨åˆ—è¡¨ã€‚

ä½¿ç”¨ `INSPECT` å‘½ä»¤æ£€æŸ¥æ¯ä¸ªçº¹ç†çš„æ–‡ä»¶å¤§å°ä»¥åŠå®ƒä»¬åœ¨ GPU å†…å­˜ä¸­çš„å¤§å°ã€‚
```
gltf-transform inspect input.glb --format md
```
`INSPECT` å‘½ä»¤çš„è¾“å‡ºç¤ºä¾‹ï¼š
![inspect command results](figures/inspect-results.jpg)

MD æ ¼å¼æ›´æ˜“äºç›´æ¥é˜…è¯»ï¼Œå¯ä»¥ç›´æ¥ç²˜è´´åˆ° Markdown æ–‡æ¡£ä¸­ã€‚CSV æ ¼å¼éå¸¸é€‚åˆåŠ è½½åˆ°ç”µå­è¡¨æ ¼ä¸­è¿›è¡Œè¿›ä¸€æ­¥çš„æ•°æ®å¤„ç†å’Œåˆ†æã€‚

---

ä¸Šä¸€ç« : [KTX Guide for glTF-Compressor](KTXArtistGuide_glTF-Compressor.cn.md) | ä¸»é¡µ: [KTX Artist Guide](../KTXArtistGuide.cn.md) | ä¸‹ä¸€ç« : [KTX Guide for RapidCompact](KTXArtistGuide_RapidCompact.cn.md)